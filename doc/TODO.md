## TODO
- Testing
    - [x] Think about offset handling in insertions
      - [ ] Write up added logic
    - [x] Think about more rep invariants, add to checkrep
    - [ ] Add more testing to offset handling
    - [ ] Add unit tests for `raw_insert` and `raw_query`, paying special attention to offset handling
    - [ ] Add integration tests (adversary, file-based, etc.)
- Organization
    - [ ] Make RSQF a super-trait of Filter
- Maybe  
  - Only store the hash in remote and ditch the word (comparing word to elt is potentially slow, faster to compare hashes)

## Debugging
### AQF false negatives
Interaction of conflicting policies is leading the extensions for two remote elts to get swapped

```
query elt=4119997257052773763, hash=48677434032986450364517961118245206850, block=Block {
    remainders: [
        "0x56 0x5 0x16 0x7 0x7 0x4f 0x6 0x0",
        "0x0 0x0 0x0 0x0 0x6c 0x44 0x3c 0x0",
        "0x1e 0xf4 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0xdc 0x0 0x2d 0x2d",
        "0x0 0x5a 0x0 0x0 0x6c 0x0 0x0 0x0",
        "0xe9 0xf9 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0x0 0x0 0x7f 0x52",
        "0x0 0x0 0x0 0x8 0x0 0x0 0x0 0x6e",
    ],
    occupieds : [1111010000001010100000000000101001001000110000000000001100010001],
    runends   : [0110111000000110010000000000100101001000110000000000001100010001],
    offset    : 1,
    extensions: 3: 0110111, 4: 01, 33: 0,
    code      : 53570588767957441,
}
ext=01
ext matches! pairs=[
    (
        "4119997257052773763",
        48677434032986450364517961118245206850,
    ),
], remote(quot=834,rem=7)=Some(
    [
        (
            01,
            "4119997257052773763",
            48677434032986450364517961118245206850,
        ),
        (
            0110111,
            "7195797671440345694",
            70248901151078643334081093243145567042,
        ),
    ],
)
true match!
```

At some point, the extension for slot 4 gets erased and the words associated with 3 and 4 are swapped.
This leads the word 411.. to get associated with the wrong extension (the extension for 719..), 
leading to a false negative.

```
query elt=4119997257052773763, hash=48677434032986450364517961118245206850, block=Block {
    remainders: [
        "0x56 0x5 0x16 0x7 0x7 0x4f 0x6 0x0",
        "0x0 0x0 0x0 0x0 0x6c 0x44 0x3c 0x0",
        "0x1e 0xf4 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0xdc 0x0 0x2d 0x2d",
        "0x0 0x5a 0x0 0x0 0x6c 0x0 0x0 0x0",
        "0xe9 0xf9 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0x0 0x0 0x7f 0x52",
        "0x0 0x0 0x0 0x8 0x0 0x0 0x0 0x6e",
    ],
    occupieds : [1111010000001010100000000000101001001000110000000000001100010001],
    runends   : [0110111000000110010000000000100101001000110000000000001100010001],
    offset    : 1,
    extensions: 3: 0110111, 33: 0,
    code      : 53570310377763105,
}
ext=_
ext matches! pairs=[
    (
        "7195797671440345694",
        70248901151078643334081093243145567042,
    ),
], remote(quot=834,rem=7)=Some(
    [
        (
            0110111,
            "4119997257052773763",
            48677434032986450364517961118245206850,
        ),
        (
            _,
            "7195797671440345694",
            70248901151078643334081093243145567042,
        ),
    ],
)
```

```
false match! adapting block=Block {
    remainders: [
        "0x56 0x5 0x16 0x7 0x7 0x4f 0x6 0x0",
        "0x0 0x0 0x0 0x0 0x6c 0x44 0x3c 0x0",
        "0x1e 0xf4 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0xdc 0x0 0x2d 0x2d",
        "0x0 0x5a 0x0 0x0 0x6c 0x0 0x0 0x0",
        "0xe9 0xf9 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0x0 0x0 0x7f 0x52",
        "0x0 0x0 0x0 0x8 0x0 0x0 0x0 0x6e",
    ],
    occupieds : [1111010000001010100000000000101001001000110000000000001100010001],
    runends   : [0110111000000110010000000000100101001000110000000000001100010001],
    offset    : 1,
    extensions: 3: 0110111, 33: 0,
    code      : 53570310377763105,
}
after adapt, block=Block {
    remainders: [
        "0x56 0x5 0x16 0x7 0x7 0x4f 0x6 0x0",
        "0x0 0x0 0x0 0x0 0x6c 0x44 0x3c 0x0",
        "0x1e 0xf4 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0xdc 0x0 0x2d 0x2d",
        "0x0 0x5a 0x0 0x0 0x6c 0x0 0x0 0x0",
        "0xe9 0xf9 0x0 0x0 0x0 0x0 0x0 0x0",
        "0x0 0x0 0x0 0x0 0x0 0x0 0x7f 0x52",
        "0x0 0x0 0x0 0x8 0x0 0x0 0x0 0x6e",
    ],
    occupieds : [1111010000001010100000000000101001001000110000000000001100010001],
    runends   : [0110111000000110010000000000100101001000110000000000001100010001],
    offset    : 1,
    extensions: 3: 0110111, 4: 11, 33: 0,
    code      : 53570592364261823,
}

```